## 2.4 DNS : 인터넷의 디렉터리 서비스

- 호스트 이름 : 인터넷 호스트의 식별자
- IP 주소 : 호스트 식별 가능

## 2.4.1 DNS 제공하는 서비스

- 인터넷 DNS :호스트 이름을 IP 주소로 변환해주는 디렉터리 서비스
- DNS
  1.  DNS 서버들의 계층구조로 구현된 분산 데이터 베이수
  2.  호스트가 분산 데이터베이스로 질의하도록 허락하는 애플리케이션 계층 프로토콜
- 호스트 에일리어싱
  - 복잡한 호스트 이름을 가진 호스트는 하나 이상의 별명을 갖을 수 있으며, **정식 호스트 이름**이라고 함
- 메일 서버 에일리어싱
  - DNS 호스트의 IP주소뿐만 아니라 제공됭 별칭 호스트 이름에 정식 호스트 이름에 얻기 위해 수행.
- 분산 부하
  - DNS 중복 웹 서버 같은 여러 중복 서버 사이 부하를 분산하기 위해 사용.

## 2.4.2 DNS 동작 원리 개요

- 호스트 이름을 IP 주소로 변환하는 서비스 초점
- 순서
  1.  애플리케이션은 변환될 호스트 이름을 명시해, DNS 측의 클라이언트 호출
  2.  사용자 호스트의 DNS 네트워크에 질의 메시지 전송
  3.  DNS 질의와 응답 메시지는 포트 53의 UDP 데이터그램으로 보냄.
  4.  수 밀리초에서 수 초의 지연 후, 사용자 호스트의 DNS 요청한 매핑에 해당하는 DNS 응답 메시지 받음.
  5.  매핑은 호출한 애플리케이션으로 전달.
- 사용자 호스트의 호출한 애플리케이션 관점으로 DNS는 간단하고 직접적인 변환서비스 제공하는 블랙박스.
- 해당 방식의 문제점
  1.  서버의 고장 : 네임 서버 고장 시, 전체 인터넷 작동 불가.
  2.  트랙픽양 : 단일 DNS 서버가 모든 DNS 질의 처리
  3.  먼 거리의 중앙 집중 데이터 베이스 : DNS서버와 질의 클라이언트의 거리가 멀수록, 지연을 일으킴.
  4.  유지관리 : 단일 네임 서버는 모든 인터넷 호스트에 대한 레코드 유지해야함.
      즉, 단일 DNS 서버 있는 중앙 집중 데이터베이스는 확장성이 없음.

### 분산 계층 데이터베이스

- 확장성 문제 다루기 위해 DNS는 많은 서버 이용, 이를 게층 형태로 구성해 전 세계에 분산.
- 단일 DNS 서버도 인터넷에 있는 모든 호스트에 대한 매핑을 갖지 않는 대신 DNS 서버 사이 분산 됨.

1. 루트 DNS 서버
   1000개 이상의 루트 서버 인스턴스가 전 세계 흩어져 있음.
   루트 서버들은 13개의 다른 루트 서버 복사체이며, 12개의 다른 기관에서 관리
   루트 네임 서버는 TLD 서버의 IP 주소들을 제공
2. 최상위 레벨 도메인(TLD) 서버
   com, org, net, edu, gov 같은 상위 레벨 도메인과 kr, uk, fr, ca, jp 같은 국가 상위 레벨 도메인에 대한 TLD서버가 있음
   TLD 서버는 책임 DNS 서버에 대한 IP 주소를 제공한다.
3. 책임 DNS 서버
   인터넷에서 접근하기 쉬운 호스트를 가진 모든 기관은 호스트 이름을 IP 주소로 매핑하는 공개적인 DNS레코드를 제공.
   자신의 기본 책임 DNS 서버와 보조 책임 DNS 서버를 유지하고 구현

### DNA 캐싱

- DNS는 지연 성능 향상과 네트워크의 DNS 메시지 줄이기 위해 캐싱 사용.
- 질의 사슬에서 DNS 서버가 DNS 응답을 받았을 때, 그것은 로컬 메모리로 응답에 대한 정보를 저장할 수 있다.
- 호스트 이름과 IP 주소 쌍이 DNS 서버에 저장되고 다른 호스트 이름으로부터 같은 질의가 DNS서버로 도착한다면, DNS 서버는 호스트 이름에 대한 책임이 없을 때조차 원하는 IP주소 제공.

## 2.4.3 DNS 레코드와 메시지

- DNS 분산 데이터베이스를 구한현 DNS 서버들은 호스트 이름을 IP주소로 매핑하기 위한 자원 레코드를 저장.
- Name, Value, Type, TTL 4개의 튜플 구성.

### DNS 메시지

- DNS 질의와 응답 메시지 두 개의 유형이 있다.
- DNS 메시지 내부의 필드
  1.  헤더 영역
      - 처음 12 바이트
      - 질의 식별하는 16비트 숫자.
      - 1비트의 질의/응답 플래그 -> 질의(0), 응답(1)
      - 1비트 책임 플래그 DNS 서버가 질의 이름에 대해 책임 서버일 때 응답 메시지에 설정.
      - 1비트의 재귀 요구 플래그는 DNS 서버가 레코드를 갖지 않을 때 재귀적 질의 수행하기를 클라이언트가 원할 때 설정
      - 비트로 구성된 재귀 가능 필드는 DNS 서버가 재귀 질의를 지원하면 응답 설정됨.
      - 4개의 개수 필드가 있음 -> 헤더 다음에 오는 데이터 영역의 네 가지 타입 횟수 나타냄.
      1. 질문 영역
         - 현재 질의 정보 포함
         - 질의 이름을 포함하는 이름 필드와 문의되는 질문 타입을 나타내는 타입 필드 포함
      2. 답변 영역
         - 원래 질의에 대한 자원 레코드 포함
         - 자원 레코드에 Type, Value, TTL
         - 응답을 여러 개의 RR을 보낼 수 있음.
      3. 책임 영역
         - 다른 책임 서버의 레코드 포함
      4. 추가 영역
         - 다른 도움이 되는 레코드 포함

### DNS 데이터베이스에 레코드 삽입

읽어보시오

## 2.5 P2P 파일 분배
