# 6.1 링크 계층 소개

### 노드

프로토콜을 실행하는 장치 

호스트, 라우터, 스위치, 와이파이 AP

### 링크

통신 경로상의 인접한 노드들을 연결하는 통신 채널

데이터그램을 출발지 호스트→ 목적지호스트 : 데이터그램을 종단간 경로의 개별 링크들로 이동시켜야함

### 링크 계층 프레임

한 링크에서 전송 노드는 데이터그램을 ~프레임으로 캡슐화해서 링크로 전송

### 비유)

여행객 : 데이터 그램 / 교통편 : 링크 / 운송 방식 : 링크 계층 프로토콜 / 여행사 직원 : 라우팅 프로토콜

## 6.1.1 링크 계층이 제공하는 서비스

### 프레임화

전송을 위해 데이터그램을 **캡슐화**함

프레임 = 데이터 필드 + 헤더필드s

프레임 구조 : 링크 계층 프로토콜에 의해 명시

### 링크 접속

MAC 프로토콜 : 링크 상으로 프레임을 전송하는 규칙 명시

점대점 링크에서 MAC 프로토콜 단순하거나 없음

링크가 사용 되지 않을때 (idle) 마다 프레임을 전송 가능 (idle : 가동되지않은, 놀고 있는)

하나의 브로드캐스트 링크를 여러 노드가 공유하는 경우 (= 디중 접속 문제), MAC 프로토콜은 여러 노드로부터 프레임 전송 조정

### 신뢰적 전달

신뢰적 전달할 경우, 데이터 그램이 링크 상에 오류없이 전달

TCP : 신뢰적 전달 서비스 제공

링크계층의 신뢰적 전달 서비스: 오류율 높은 무선 링크에서 주로 사용

트랜스포트 계층 프로토콜 & 애플리케이션 계층 프로토콜 : 재전송

링크계층 프로토콜 :오류가 발생한 링크에서 오류 정정

낮은 비트 오류율을 가진 링크 (광섬유, 동축케이블, 다수의 꼬임쌍 선 링크) : 불필요한 오버헤드로 신뢰적 전달 제공 X

### 오류 검출과 정정

수신 노드의 링크 계층 하드웨어 : 1→0(그반대로) 오인 가능성 있음

비트 오류 : 신호의 약화, 전자기 잡음이 원인

오류가 있는 데이터그램 전달 필요 X → 대다수 링크 계층은 오류 검출 방법 O

오류 검출 

- 송신 노드측, 프레임에 오류 검출 비트를 설정하게 하고, 수신 노드에서 오류 검사를 수행하게 함
- 링크 계층 프로토콜에서 흔한 일반적인 서비스
- 링크 계층의 오류 검출은 아래 계층의 것들보다 더 복잡 & 하드웨어로 구현
    - 인터넷-트랜스포트 계층& 네트워크 계층-제한된 형태의 오류검출 제공 (3,4장)
- 오류 정정
    - 오류 검출 + 프레임 내 정확한 오류 위치

## 6.1.2 링크 계층이 구현되는 위치

종단 시스템에서 링크 계층 구현하는 방법 알아보기

링크 계층 → HW?SW?, 별도의 카드나 칩?, 호스트의 나머지 하드웨어나 OS 구성요소와 어떻게 인터페이스 하는지 알아보기

# 6.2 오류 검출 및 정정 기술

## 6.2.1 패리티 검사

가장 단순한 형태의 오류 검출

짝수 패리티 기법 : 단순히 한비트 추가 → 그 비트 값을 d+1개의 비트들에서 1의 총 개수가 짝수가 되도록 선택

홀수 패리티 기법 : 패리티 비트값을 1이 홀수개가 되도록 선택

수신자의 동작도 단순 : 수신된 d+1개의 비트들에서 1의 개수 계산하면 됌

## 6.2.2 체크섬 방법

인터넷 체크섬에서 이 방법을 사용

1의 보수가 인터넷 체크섬이 되며, 세그먼트 헤더에 넣어줌

수신자는 수신데이터 합의 1의 보수를 취한 후 그 결과과 모두 1인 비트로 구성되어있는지 계산

⇒ 한 비트라도 0이면 오류

## 6.2.3. 순환 중복 검사 (CRC)

오늘날 가장 널리 사용됌 

CRC코드 = 다항식 코드 → 전송되는 비트열에 있는 0과 1값을 계수로 갖는 다항식처럼 비트열 생각 / 비트열에 적용되는 연산을 다항식 연산 이해

# 6.3 다중 접속 링크와 프로토콜

### 6.3.1 채널 분할 프로토콜

TDM 

여러 사용자가 동일한 주파수 대역을 공유

순차적으로 시간 슬롯을 할당받아 통신하는 접속 방식

각 사용자는 할당된 시간 슬롯 동안에만 패킷(데이터)를 전송 가능

그 외에 시간에는 다른 사용자가 해당 주파수 대역을 사용

FDM

여러 사용자가 동시에 통신 ← 사용자에게 고유한 주파수 대역을 할당

각 사용자는 할당받은 주파수 대역 내에서만 통신

다른 사용자의 주파수 대역과 겹치지 않음

### 6.3.2 랜덤 접속 프로토콜

각 노드는 데이터를 전송할 때마다 채널에 무작위로 접근

충돌이 발생하면 노드는 임의의 시간 동안 대기하고 재전송

데이터를 재전송하기 위해 임의의 시간을 대기

### 슬롯 알로하

시간을 균일한 길이의 슬롯(slot)으로 나눔

각 호스트는 슬롯의 시작 시점에만 프레임(frame)을 전송할 수 있음

슬롯 경계 밖에서 전송이 시작되면 그 프레임은 무효(충돌)로 간주

### 알로하

초기 ALOHA는 특정 시간에 데이터를 전송하고 일정 시간 동안 응답을 기다린다. 만약 응답을 받지 못하면 패킷이 다른 패킷과 충돌했다고 가정하고 재전송을 시도한다.

Slotted ALOHA는 이러한 ALOHA에서 발전된 프로토콜이다. 시간을 동일한 크기의 슬롯으로 나누고 이 슬롯 시작 시간에만 데이터를 전송할 수 있다. 슬롯으로 나눈 특정 시간 구간 내로 전송을 제한하기 때문에 충돌의 가능성을 줄이는데 도움이 되며 높은 통신 효율성과 구현의 간단함을 보여준다.

그러나 모든 장치가 동일한 슬롯시간에 맞춰 동작하도록 시간 동기화 작업이 필요하다.

### CSMA

데이터를 전송하기 전에 채널이 사용 중인지 감지

채널이 사용 중이라면, 전송을 지연시키고 나중에 다시 시도

충돌을 감지하지는 X

### CSMA/CD

CSMA 기능에 추가로 충돌을 감지

데이터를 전송하는 동안 충돌이 감지되면 전송을 중단하고 잠시 후 다시 시도

유선 네트워크(이더넷)에서 사용

### CSMA/CD의 효율

### 6.3.3 순번 프로토콜

폴링 프로토콜

마스터 노드 - 각 노드를 라운드로빈 방식으로 폴링

높은 효율 

단점 1. 폴링 지연 2. 마스터 노드 고장시, 전체 채널 동작 X

토큰 전달 프로토콜

토큰을 순서대로 노드간 전달

높은 효율

노드 하나 실패시 전체 동작 X

### 6.3.4 DOCSIS : 케이블 인터넷 접속을 위한 링크 계층 프로토콜

케이블 데이터 네트워크의 구조와 프로토콜 정의

DOCSIS는 하향 및 상향 네트워크 세그먼트들을 다수의 주파수 채널로 나누기 위해 FDM을 사용

각 상향 및 하향 채널은 브로드캐스트 채널

하향 채널

24~192 MHz 대역에 약 1.6 Gbps의 최대 처리율을 제공

CMTS에 의해 하향 채널로 전송된 프레임은 그 채널을 통해 수신하는 모든 케이블 모뎀에 의해 수신

MAP 메시지로 알려진 제어 메시지를 보냄

→ 어떤 케이블 모뎀이 MAP 메시지에서 명시한 시간 간격 동안 어떤 미니슬롯으로 전송

상향 채널

6.4~96 MHz 대역에 약 1 Gps의 최대 상향 처리율을 제공

다수의 케이블 모뎀이 CMTS로의 동일한 상향 채널(주파수)을 공유하여 충돌이 발생
