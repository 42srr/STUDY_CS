# 5.1 ~ 5.4

## **5.1 네트워크 계층 제어 평면 개요**

## **포워딩 테이블과 플로우 테이블의 역할**

- **데이터 평면과 제어 평면 연결**:
    
    포워딩 테이블(목적지 기반)과 플로우 테이블(일반화된 포워딩)은 네트워크 계층의 데이터 평면 동작을 정의하며, 제어 평면에서 생성/관리
    
    - **전통적 포워딩**: 목적지 IP 기반으로 출력 포트 선택
    - **일반화된 포워딩**: 헤더 필드(IP, TCP/UDP 포트 등)를 매치하여 복잡한 액션(전달, 삭제, 헤더 수정, 로드 밸런싱) 수행

## **제어 평면 접근 방식 비교**

## **1. 라우터별 제어 (분산형)**

- **구조**:
    - 각 라우터는 독립적인 라우팅 알고리즘(OSPF, BGP)을 실행하며, 이웃 라우터와 정보를 교환합니다
    - 라우팅 테이블에서 최적 경로를 계산한 후 FIB(Forwarding Information Base) 테이블로 전달
- **특징**:
    - **장점**: 장애 발생 시 신속한 경로 재계산 가능.
    - **예시**: Juniper의 라우팅 테이블은 유니캐스트/멀티캐스트/MPLS를 별도로 관리

## **2. 논리적 중앙 집중형 제어 (SDN)**

- **구조**:
    - 원격 컨트롤러가 플로우 테이블을 계산하여 라우터의 CA(Control Agent)에 배포
    - OpenFlow는 12튜플 키(IP, MAC, 포트 등)를 기반으로 패킷 처리 규칙을 정의
- **특징**:
    - **유연성**: 매치 플러스 액션 규칙으로 방화벽, NAT, 로드 밸런싱 통합 가능
    - **동작 예**:
        - 테이블-미스 발생 시 컨트롤러로 패킷 전송
        - **파이프라인 처리**: 다중 플로우 테이블을 순차적으로 적용

## **테이블 생성 및 관리 메커니즘**

| **구분** | **라우터별 제어** | **중앙 집중형 제어** |
| --- | --- | --- |
| **테이블 생성 주체** | 라우터 자체의 라우팅 프로토콜 | SDN 컨트롤러 |
| **통신 방식** | 라우터 간 직접 정보 교환 (예: OSPF) | CA와 컨트롤러 간 OpenFlow 프로토콜 |
| **유지 관리** | 주기적 라우팅 업데이트 | 실시간 플로우 규칙 동적 조정 |
| **확장성** | 제한적 (분산 알고리즘 복잡도 증가) | 높음 (중앙 집중 로직) |

## **일반화된 포워딩의 확장성**

- **헤더 필드 활용**:
    - OpenFlow 1.0은 11개 헤더 필드 + 수신 포트를 매치 기준으로 사용
    - 예: VLAN 태그 또는 TCP 포트 기반 트래픽 분할
- **액션 다양성**:
    - 패킷 복제, 필드 재작성(예: NAT), QoS 적용

## **사례 분석:**

- **로드 밸런싱**:
    - 목적지 IP가 동일한 트래픽을 다른 경로로 분배 (전통적 라우팅으로 불가)
- **방화벽 정책**:
    - 특정 서브넷(**`10.3.*.*`**)에서의 트래픽만 허용하는 플로우 규칙 구현

## 5.2 라우팅 알고리즘

### **라우팅 알고리즘의 목표**

- 송신자에서 수신자로 가는 **최소 비용 경로(least-cost path)**를 결정.
- 현실적으로 네트워크 정책 등 추가적인 제약 조건이 고려됨.

---

### **그래프 모델**

- **그래프 G(N, E)**:
    - `N`: 노드(라우터).
    - `E`: 에지(라우터 간 물리적 링크, 비용 포함).
- **경로 비용**: 경로 상 모든 에지 비용의 합.

---

### **라우팅 알고리즘 분류**

### 1. **중앙 집중형 vs 분산형**

- **중앙 집중형 라우팅 알고리즘**:
    - 네트워크 전체 정보를 사용해 최소 비용 경로 계산.
    - 예: **링크 상태(Link-State, LS) 알고리즘**.
- **분산 라우팅 알고리즘**:
    - 각 노드가 이웃과 정보 교환을 통해 점진적으로 최소 비용 경로 계산.
    - 예: **거리 벡터(Distance-Vector, DV) 알고리즘**.

### 2. **정적 vs 동적**

- **정적 라우팅 알고리즘**:
    - 사람이 개입하여 설정, 경로 변경이 느림.
- **동적 라우팅 알고리즘**:
    - 네트워크 상태(부하, 토폴로지 변화)에 따라 경로를 동적으로 변경.
    - 장점: 빠른 적응. 단점: 루프 및 진동 문제 발생 가능.

### 3. **부하 민감 여부**

- **부하 민감한 알고리즘**:
    - 링크 혼잡도를 반영해 동적으로 비용을 조정.
- **부하 민감하지 않은 알고리즘**:
    - 현재 혼잡을 반영하지 않음(예: RIP, OSPF, BGP).

---

### **링크 상태 (LS) 라우팅 알고리즘**

- 네트워크 전체 정보를 사용해 다익스트라(Dijkstra) 알고리즘으로 최소 비용 경로 계산.
- 각 노드가 링크 상태 패킷을 브로드캐스트하여 네트워크 정보를 공유.
- 계산 복잡도: O(n²), n은 노드 수.
- 문제점: 진동(oscillation) 문제 발생 가능.

### **포워딩 테이블**

- LS 알고리즘 결과를 바탕으로 각 노드는 목적지까지의 최소 비용 경로와 다음 홉(next hop)을 저장.

---

### **거리 벡터 (DV) 라우팅 알고리즘**

- 반복적, 분산적, 비동기적으로 동작.
- 벨만-포드(Bellman-Ford) 식을 사용해 최소 비용 경로 계산:
    
    ```
    Dx(y) = min {c(x, v) + Dv(y)}
    
    ```
    
    - `Dx(y)`: 노드 x에서 y까지의 최소 비용 경로 추정값.
    - `c(x, v)`: x에서 이웃 v까지의 링크 비용.
    - `Dv(y)`: v에서 y까지의 최소 비용 경로 추정값.
- 문제점: 무한 계수(count-to-infinity), 라우팅 루프 발생 가능.

### **포이즌 리버스(Poisoned Reverse)**

- 루프 방지를 위해 특정 경로를 무한대로 설정하지만 모든 루프를 방지하지는 못함.

---

### **LS와 DV 알고리즘 비교**

| **특징** | **링크 상태 (LS)** | **거리 벡터 (DV)** |
| --- | --- | --- |
| **경로 계산 방법** | 네트워크 전체 정보를 사용해 중앙 집중적으로 계산 | 분산적으로 계산 (이웃과 정보 교환) |
| **메시지 복잡성** | O(|N| |E|) | N |
| **견고성** | 잘못된 정보가 국소적으로만 영향을 미침 | 잘못된 정보가 전체 네트워크에 확산될 수 있음 |

---

링크 상태와 거리 벡터 라우팅 알고리즘은 각각 장단점이 있으며, 실제 네트워크에서는 OSPF(LS 기반), RIP(DV 기반), BGP와 같은 프로토콜에 적용되어 사용됨. SDN 환경에서는 중앙 집중형 방식이 선호되며, 기존 인터넷에서는 분산형 방식이 주로 사용.

## **5.3 인터넷에서의 AS 내부 라우팅**

## **AS(자율 시스템)의 필요성**

- **확장성 문제**: 라우터 수 증가 시 라우팅 정보 오버헤드가 기하급수적으로 증가
- **관리 자율성**: ISP는 자체 네트워크 운영 방식과 내부 구성을 외부에 노출하지 않으려 함
- **해결책**: 라우터를 AS로 조직화하고, 각 AS는 고유한 ASN(Autonomous System Number)으로 식별됨

## **OSPF 프로토콜 개요**

- **역할**: AS 내부에서 **링크 상태 알고리즘**을 기반으로 최단 경로 계산
- **동작 방식**:
    - 링크 상태 정보를 플러딩(flooding)하여 전체 AS 토폴로지 맵 구성.
    - 다익스트라 알고리즘으로 최소 비용 경로 트리 생성
- **특징**:
    - 상위 계층 프로토콜 번호 **89** 사용
    - 링크 상태 변경 시 즉시 업데이트, 30분마다 정기적 갱신

## **OSPF의 주요 기능**

## **1. 계층적 구조 (Hierarchical Areas)**

- AS를 영역(Area)으로 분할하여 라우팅 오버헤드 감소:
    - 각 영역은 독립적인 링크 상태 데이터베이스 관리.
    - 백본 영역(Area 0)이 다른 영역 간 트래픽 중계.
    - 영역 경계 라우터(ABR)가 영역 외부 라우팅 담당.

## **2. 보안 메커니즘**

- **단순 인증**: 평문 패스워드 사용 (보안 취약)
- **MD5 인증**: 128비트 암호화 해시로 라우터 신원 검증
    - LSA 변조 방지 및 라우팅 테이블 무결성 보장.

## **3. 동일 비용 다중 경로(ECMP)**

- 최대 4개의 동일 비용 경로를 로드 밸런싱
    - 트래픽 분산으로 대역폭 활용도 향상.
    - 경로 장애 시 자동 재라우팅

## **4. 링크 가중치 설정 유연성**

- 관리자가 트래픽 관리 목표에 따라 링크 비용 조정 가능:
    - 예: 용량 반비례 가중치 설정으로 저대역폭 링크 사용 억제

## **OSPF vs RIP 비교

| **기능** | **OSPF** | **RIP** |
| --- | --- | --- |
| **수렴 속도** | 빠름 (직접 LSA 플러딩) | 느림 (홉 단위 업데이트) |
| **루프 방지** | 강함 (전체 토폴로지 가시성) | 약함 (Count-to-Infinity 문제) |
| **부하 분산** | ECMP 지원 (최대 4개 경로) | 단일 경로 선택 |
| **보안** | MD5 인증 지원 | 기본 인증 없음 |

## **OSPF의 한계 및 해결 방안**

1. **확장성 제약**:
    - 대규모 AS에서는 영역 분할로 오버헤드 관리
    - **Compact Routing** 기법으로 라우팅 테이블 크기 최적화
2. **링크 장애 대응**:
    - **Tabu Search** 휴리스틱으로 장애 시 가중치 재설정
3. **이기종 네트워크 통합**:
    - **BGP**와 연동하여 AS 간 라우팅 처리

## **5.4 인터넷 서비스 제공업자(ISP) 간의 라우팅**

## **BGP(Border Gateway Protocol)의 역할**

- **AS(Autonomous System) 간 라우팅 프로토콜**:
    - 여러 AS를 통과하는 패킷을 라우팅.
    - CIDR(Classless Inter-Domain Routing) 형식으로 주소 프리픽스 전달.
- **주요 기능**:
    1. 이웃 AS를 통해 도달 가능한 서브넷 프리픽스 정보를 수집.
    2. 서브넷 프리픽스로의 최적 경로 결정.

## **BGP의 동작 방식**

## **1. BGP 연결**

- **eBGP**: 서로 다른 AS 간의 게이트웨이 라우터 연결.
- **iBGP**: 같은 AS 내의 라우터 연결.
- 모든 BGP 메시지는 TCP 포트 **179**를 통해 전송.

## **2. 경로 정보 알리기**

- 게이트웨이 라우터 간 eBGP 메시지 교환 → iBGP로 내부 라우터에 정보 전달.
- 경로는 AS-PATH(통과한 AS 리스트)와 NEXT-HOP(다음 홉 IP 주소) 속성을 포함.

## **3. 경로 선택 알고리즘**

- 여러 경로 중 최적 경로를 선택:
    1. **지역 선호도(Local Preference)**: 가장 높은 값을 가진 경로 우선.
    2. **최단 AS-PATH**: 통과 AS 수가 적은 경로 선택.
    3. **뜨거운 감자 라우팅(Hot Potato Routing)**:
        - NEXT-HOP까지의 내부 비용이 최소인 경로 선택.

## **BGP와 IP 애니캐스트**

- 애니캐스트는 동일한 IP 주소를 가진 여러 서버 중 가장 가까운 서버로 트래픽을 전달.
- BGP 경로 선택 알고리즘을 활용해 최적의 경로를 결정.

## **라우팅 정책**

- AS 간 라우팅은 정책 기반:
    - 특정 트래픽이 특정 AS를 통과하지 못하도록 제한 가능.
    - ISP는 고객 트래픽만 전달하며, 다른 ISP 간 트래픽은 중계하지 않음.

## **AS 내부와 외부 라우팅의 차이점**

| **구분** | **AS 내부 라우팅 (e.g., OSPF)** | **AS 간 라우팅 (e.g., BGP)** |
| --- | --- | --- |
| **목적** | 성능 최적화 | 정책 준수 및 확장성 |
| **관리 주체** | 단일 관리 제어 | 다중 관리 제어 |
| **확장성** | 중요하지 않음 | 매우 중요 |

## **IP 주소 및 BGP 설정 과정 예시**

1. 회사가 ISP와 계약하여 IP 주소 범위를 할당받음.
2. DNS 서버와 도메인 이름 등록 후, DNS 시스템에 IP 주소 등록.
3. ISP는 BGP를 통해 회사의 주소 프리픽스를 다른 ISP에 알림.
4. 외부 사용자는 DNS를 통해 회사 웹 서버 IP를 얻고, 패킷을 전송.# 5.1 ~ 5.4

## **5.1 네트워크 계층 제어 평면 개요**

## **포워딩 테이블과 플로우 테이블의 역할**

- **데이터 평면과 제어 평면 연결**:
    
    포워딩 테이블(목적지 기반)과 플로우 테이블(일반화된 포워딩)은 네트워크 계층의 데이터 평면 동작을 정의하며, 제어 평면에서 생성/관리
    
    - **전통적 포워딩**: 목적지 IP 기반으로 출력 포트 선택
    - **일반화된 포워딩**: 헤더 필드(IP, TCP/UDP 포트 등)를 매치하여 복잡한 액션(전달, 삭제, 헤더 수정, 로드 밸런싱) 수행

## **제어 평면 접근 방식 비교**

## **1. 라우터별 제어 (분산형)**

- **구조**:
    - 각 라우터는 독립적인 라우팅 알고리즘(OSPF, BGP)을 실행하며, 이웃 라우터와 정보를 교환합니다
    - 라우팅 테이블에서 최적 경로를 계산한 후 FIB(Forwarding Information Base) 테이블로 전달
- **특징**:
    - **장점**: 장애 발생 시 신속한 경로 재계산 가능.
    - **예시**: Juniper의 라우팅 테이블은 유니캐스트/멀티캐스트/MPLS를 별도로 관리

## **2. 논리적 중앙 집중형 제어 (SDN)**

- **구조**:
    - 원격 컨트롤러가 플로우 테이블을 계산하여 라우터의 CA(Control Agent)에 배포
    - OpenFlow는 12튜플 키(IP, MAC, 포트 등)를 기반으로 패킷 처리 규칙을 정의
- **특징**:
    - **유연성**: 매치 플러스 액션 규칙으로 방화벽, NAT, 로드 밸런싱 통합 가능
    - **동작 예**:
        - 테이블-미스 발생 시 컨트롤러로 패킷 전송
        - **파이프라인 처리**: 다중 플로우 테이블을 순차적으로 적용

## **테이블 생성 및 관리 메커니즘**

| **구분** | **라우터별 제어** | **중앙 집중형 제어** |
| --- | --- | --- |
| **테이블 생성 주체** | 라우터 자체의 라우팅 프로토콜 | SDN 컨트롤러 |
| **통신 방식** | 라우터 간 직접 정보 교환 (예: OSPF) | CA와 컨트롤러 간 OpenFlow 프로토콜 |
| **유지 관리** | 주기적 라우팅 업데이트 | 실시간 플로우 규칙 동적 조정 |
| **확장성** | 제한적 (분산 알고리즘 복잡도 증가) | 높음 (중앙 집중 로직) |

## **일반화된 포워딩의 확장성**

- **헤더 필드 활용**:
    - OpenFlow 1.0은 11개 헤더 필드 + 수신 포트를 매치 기준으로 사용
    - 예: VLAN 태그 또는 TCP 포트 기반 트래픽 분할
- **액션 다양성**:
    - 패킷 복제, 필드 재작성(예: NAT), QoS 적용

## **사례 분석:**

- **로드 밸런싱**:
    - 목적지 IP가 동일한 트래픽을 다른 경로로 분배 (전통적 라우팅으로 불가)
- **방화벽 정책**:
    - 특정 서브넷(**`10.3.*.*`**)에서의 트래픽만 허용하는 플로우 규칙 구현

## 5.2 라우팅 알고리즘

### **라우팅 알고리즘의 목표**

- 송신자에서 수신자로 가는 **최소 비용 경로(least-cost path)**를 결정.
- 현실적으로 네트워크 정책 등 추가적인 제약 조건이 고려됨.

---

### **그래프 모델**

- **그래프 G(N, E)**:
    - `N`: 노드(라우터).
    - `E`: 에지(라우터 간 물리적 링크, 비용 포함).
- **경로 비용**: 경로 상 모든 에지 비용의 합.

---

### **라우팅 알고리즘 분류**

### 1. **중앙 집중형 vs 분산형**

- **중앙 집중형 라우팅 알고리즘**:
    - 네트워크 전체 정보를 사용해 최소 비용 경로 계산.
    - 예: **링크 상태(Link-State, LS) 알고리즘**.
- **분산 라우팅 알고리즘**:
    - 각 노드가 이웃과 정보 교환을 통해 점진적으로 최소 비용 경로 계산.
    - 예: **거리 벡터(Distance-Vector, DV) 알고리즘**.

### 2. **정적 vs 동적**

- **정적 라우팅 알고리즘**:
    - 사람이 개입하여 설정, 경로 변경이 느림.
- **동적 라우팅 알고리즘**:
    - 네트워크 상태(부하, 토폴로지 변화)에 따라 경로를 동적으로 변경.
    - 장점: 빠른 적응. 단점: 루프 및 진동 문제 발생 가능.

### 3. **부하 민감 여부**

- **부하 민감한 알고리즘**:
    - 링크 혼잡도를 반영해 동적으로 비용을 조정.
- **부하 민감하지 않은 알고리즘**:
    - 현재 혼잡을 반영하지 않음(예: RIP, OSPF, BGP).

---

### **링크 상태 (LS) 라우팅 알고리즘**

- 네트워크 전체 정보를 사용해 다익스트라(Dijkstra) 알고리즘으로 최소 비용 경로 계산.
- 각 노드가 링크 상태 패킷을 브로드캐스트하여 네트워크 정보를 공유.
- 계산 복잡도: O(n²), n은 노드 수.
- 문제점: 진동(oscillation) 문제 발생 가능.

### **포워딩 테이블**

- LS 알고리즘 결과를 바탕으로 각 노드는 목적지까지의 최소 비용 경로와 다음 홉(next hop)을 저장.

---

### **거리 벡터 (DV) 라우팅 알고리즘**

- 반복적, 분산적, 비동기적으로 동작.
- 벨만-포드(Bellman-Ford) 식을 사용해 최소 비용 경로 계산:
    
    ```
    Dx(y) = min {c(x, v) + Dv(y)}
    
    ```
    
    - `Dx(y)`: 노드 x에서 y까지의 최소 비용 경로 추정값.
    - `c(x, v)`: x에서 이웃 v까지의 링크 비용.
    - `Dv(y)`: v에서 y까지의 최소 비용 경로 추정값.
- 문제점: 무한 계수(count-to-infinity), 라우팅 루프 발생 가능.

### **포이즌 리버스(Poisoned Reverse)**

- 루프 방지를 위해 특정 경로를 무한대로 설정하지만 모든 루프를 방지하지는 못함.

---

### **LS와 DV 알고리즘 비교**

| **특징** | **링크 상태 (LS)** | **거리 벡터 (DV)** |
| --- | --- | --- |
| **경로 계산 방법** | 네트워크 전체 정보를 사용해 중앙 집중적으로 계산 | 분산적으로 계산 (이웃과 정보 교환) |
| **메시지 복잡성** | O(|N| |E|) | N |
| **견고성** | 잘못된 정보가 국소적으로만 영향을 미침 | 잘못된 정보가 전체 네트워크에 확산될 수 있음 |

---

링크 상태와 거리 벡터 라우팅 알고리즘은 각각 장단점이 있으며, 실제 네트워크에서는 OSPF(LS 기반), RIP(DV 기반), BGP와 같은 프로토콜에 적용되어 사용됨. SDN 환경에서는 중앙 집중형 방식이 선호되며, 기존 인터넷에서는 분산형 방식이 주로 사용.

## **5.3 인터넷에서의 AS 내부 라우팅**

## **AS(자율 시스템)의 필요성**

- **확장성 문제**: 라우터 수 증가 시 라우팅 정보 오버헤드가 기하급수적으로 증가
- **관리 자율성**: ISP는 자체 네트워크 운영 방식과 내부 구성을 외부에 노출하지 않으려 함
- **해결책**: 라우터를 AS로 조직화하고, 각 AS는 고유한 ASN(Autonomous System Number)으로 식별됨

## **OSPF 프로토콜 개요**

- **역할**: AS 내부에서 **링크 상태 알고리즘**을 기반으로 최단 경로 계산
- **동작 방식**:
    - 링크 상태 정보를 플러딩(flooding)하여 전체 AS 토폴로지 맵 구성.
    - 다익스트라 알고리즘으로 최소 비용 경로 트리 생성
- **특징**:
    - 상위 계층 프로토콜 번호 **89** 사용
    - 링크 상태 변경 시 즉시 업데이트, 30분마다 정기적 갱신

## **OSPF의 주요 기능**

## **1. 계층적 구조 (Hierarchical Areas)**

- AS를 영역(Area)으로 분할하여 라우팅 오버헤드 감소:
    - 각 영역은 독립적인 링크 상태 데이터베이스 관리.
    - 백본 영역(Area 0)이 다른 영역 간 트래픽 중계.
    - 영역 경계 라우터(ABR)가 영역 외부 라우팅 담당.

## **2. 보안 메커니즘**

- **단순 인증**: 평문 패스워드 사용 (보안 취약)
- **MD5 인증**: 128비트 암호화 해시로 라우터 신원 검증
    - LSA 변조 방지 및 라우팅 테이블 무결성 보장.

## **3. 동일 비용 다중 경로(ECMP)**

- 최대 4개의 동일 비용 경로를 로드 밸런싱
    - 트래픽 분산으로 대역폭 활용도 향상.
    - 경로 장애 시 자동 재라우팅

## **4. 링크 가중치 설정 유연성**

- 관리자가 트래픽 관리 목표에 따라 링크 비용 조정 가능:
    - 예: 용량 반비례 가중치 설정으로 저대역폭 링크 사용 억제

## **OSPF vs RIP 비교[8](https://www.alotceriot.com/what-is-ospf-open-shortest-path-first-routing-protocol/)**

| **기능** | **OSPF** | **RIP** |
| --- | --- | --- |
| **수렴 속도** | 빠름 (직접 LSA 플러딩) | 느림 (홉 단위 업데이트) |
| **루프 방지** | 강함 (전체 토폴로지 가시성) | 약함 (Count-to-Infinity 문제) |
| **부하 분산** | ECMP 지원 (최대 4개 경로) | 단일 경로 선택 |
| **보안** | MD5 인증 지원 | 기본 인증 없음 |

## **OSPF의 한계 및 해결 방안**

1. **확장성 제약**:
    - 대규모 AS에서는 영역 분할로 오버헤드 관리
    - **Compact Routing** 기법으로 라우팅 테이블 크기 최적화
2. **링크 장애 대응**:
    - **Tabu Search** 휴리스틱으로 장애 시 가중치 재설정
3. **이기종 네트워크 통합**:
    - **BGP**와 연동하여 AS 간 라우팅 처리

## **5.4 인터넷 서비스 제공업자(ISP) 간의 라우팅**

## **BGP(Border Gateway Protocol)의 역할**

- **AS(Autonomous System) 간 라우팅 프로토콜**:
    - 여러 AS를 통과하는 패킷을 라우팅.
    - CIDR(Classless Inter-Domain Routing) 형식으로 주소 프리픽스 전달.
- **주요 기능**:
    1. 이웃 AS를 통해 도달 가능한 서브넷 프리픽스 정보를 수집.
    2. 서브넷 프리픽스로의 최적 경로 결정.

## **BGP의 동작 방식**

## **1. BGP 연결**

- **eBGP**: 서로 다른 AS 간의 게이트웨이 라우터 연결.
- **iBGP**: 같은 AS 내의 라우터 연결.
- 모든 BGP 메시지는 TCP 포트 **179**를 통해 전송.

## **2. 경로 정보 알리기**

- 게이트웨이 라우터 간 eBGP 메시지 교환 → iBGP로 내부 라우터에 정보 전달.
- 경로는 AS-PATH(통과한 AS 리스트)와 NEXT-HOP(다음 홉 IP 주소) 속성을 포함.

## **3. 경로 선택 알고리즘**

- 여러 경로 중 최적 경로를 선택:
    1. **지역 선호도(Local Preference)**: 가장 높은 값을 가진 경로 우선.
    2. **최단 AS-PATH**: 통과 AS 수가 적은 경로 선택.
    3. **뜨거운 감자 라우팅(Hot Potato Routing)**:
        - NEXT-HOP까지의 내부 비용이 최소인 경로 선택.

## **BGP와 IP 애니캐스트**

- 애니캐스트는 동일한 IP 주소를 가진 여러 서버 중 가장 가까운 서버로 트래픽을 전달.
- BGP 경로 선택 알고리즘을 활용해 최적의 경로를 결정.

## **라우팅 정책**

- AS 간 라우팅은 정책 기반:
    - 특정 트래픽이 특정 AS를 통과하지 못하도록 제한 가능.
    - ISP는 고객 트래픽만 전달하며, 다른 ISP 간 트래픽은 중계하지 않음.

## **AS 내부와 외부 라우팅의 차이점**

| **구분** | **AS 내부 라우팅 (e.g., OSPF)** | **AS 간 라우팅 (e.g., BGP)** |
| --- | --- | --- |
| **목적** | 성능 최적화 | 정책 준수 및 확장성 |
| **관리 주체** | 단일 관리 제어 | 다중 관리 제어 |
| **확장성** | 중요하지 않음 | 매우 중요 |

## **IP 주소 및 BGP 설정 과정 예시**

1. 회사가 ISP와 계약하여 IP 주소 범위를 할당받음.
2. DNS 서버와 도메인 이름 등록 후, DNS 시스템에 IP 주소 등록.
3. ISP는 BGP를 통해 회사의 주소 프리픽스를 다른 ISP에 알림.
4. 외부 사용자는 DNS를 통해 회사 웹 서버 IP를 얻고, 패킷을 전송.
