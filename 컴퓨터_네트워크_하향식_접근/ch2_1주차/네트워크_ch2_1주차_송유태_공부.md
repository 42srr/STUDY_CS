# 2. 애플리케이션 계층

## 2.1 네트워크 애플리케이션의 원리

- 네트워크 애플리케이션 = 다른 위치의 종단 시스템에서 동작하고 네트워크를 통해 서로 통신하는 프로그램
- 사용자의 호스트에서 실행되는 브라우저 프로그램과 웹서버 호스트에서 실행되는 웹서버 프로그램으로 나뉨
- 네트워크 애플리케이션은 종단 시스템에만 존재함

### 2.1.1 네트워크 애플리케이션 구조

- 클라이언트-서버 구조와 P2P 구조로 나뉨
- 클라이언트-서버 구조 = 항상 동작하고 있는 호스트인 서버와 서버에 요청을 하는 클라이언트 호스트로 구성됨
- 다수의 요청을 처리하기위해 데이터 센터가 등장함
- P2P 구조에서는 피어라는 간헐적으로 연결된 호스트 쌍이 서버를 거치지 않고 직접 통신함

### 2.1.2 프로세스 간 통신

- 실제로 통신하는 것은 프로그램이 아니라 프로세스
- 프로세스 = 종단 시스템에서 실행되는 프로그램
- 네트워크 애플리케이션은 네트워크에서 서로 메시지를 보내는 두 프로세스로 구성됨
- 클라이언트 = 두 프로세스간의 통신 세션에서 통신을 초기화 하는 프로세스
- 서버 = 세션을 시작하기 위해 접속을 기다리는 프로세스
- 프로세스는 소켓을 통해 메시지를 주고받음
- 소켓 = 애플리케이션 계층과 트랜스포트 계층 간의 인터페이스
- 인터넷에서 호스트는 IP주소로 식별되며 포트번호도 식별에 사용됨

### 2.1.3 애플리케이션이 이용 가능한 트랜스포트 서비스

- 송신측 애플리케이션 - 소켓 - 트랜스포트 프로토콜 - 소켓 - 수신측 애플리케이션
- 신뢰적 데이터 전송 = 프로토콜이 보장된 데이터 전송 서비스를 제공함
- 손실 허용 애플리케이션 = 오디오, 비디오 등 멀티미디어 애플리케이션에서는 어느정도의 손실이 허용됨
- 처리율 = 통신 세션에서 송신 프로세스가 수신 프로세스로 비트를 전달할 수 있는 비율
- 대역폭 민감 애플리케이션 = 처리율 요구사항을 갖는 애플리케이션
- 탄력적 애플리케이션 = 대역폭에 민감하지 않은 애플리케이션
- 트랜스포트 프로토콜은 기밀성, 무결성, 종단 인증 등의 보안 서비스를 제공

### 2.1.4 인터넷 전송 프로토콜이 제공하는 서비스

- 인터넷은 애플리케이션에게 TCP와 UDP를 제공함
- TCP = 연결지향형 서비스와 신뢰적인 데이터 전송 서비스를 포함
- 연결지향형 서비스 = 클라이언트와 서버가 핸드셰이킹 하면 두 프로세스의 소켓 사이에 TCP 연결이 존재함. 이 연결은 서로에게 메시지를 보낼 수 있어서 전이중 연결이라고 부름.
- 신뢰적인 데이터 전송 서비스 = TCP는 어느 한쪽이 바이트 스트림을 소켓에 전달하면 손실이나 중복 없이 수신 소켓으로 전달
- 혼잡제어방식 = 프로세스의 직접 이득보다는 인터넷의 전체 성능 향상을 위한 서비스를 포함. TCP는 네트워크 혼잡시 프로세스 속도를 낮춤
- UDP = 비연결형이라 핸드셰이킹 없이 비신뢰적인 데이터 전송 서비스를 제공하며 혼잡 제어 방식을 포함하지 않음
- TCP와 UDP는 장단점이 있으며 상황에 따라 선택하면 됨

### 2.1.5 애플리케이션 계층 프로토콜

- 애플리케이션 계층 프로토콜 = 다른 종단 시스템에서 실행되는 애플리케이션의 프로세스가 서로 메시지를 보내는 방법을 정의
  - 교환 메시지 타입
  - 여러 메시지 타입의 문법
  - 필드의 의미
  - 언제, 어떻게 전송하는지 결정하는 규칙
- 애플리케이션 계층 프로토콜은 네트워크 애플리케이션의 한 요소일 뿐임

### 2.1.6 이 책에서 다루는 네트워크 애플리케이션

## 2.2 웹과 HTTP

### 2.2.1 HTTP 개요

- HTTP = 애플리케이션 계층 프로토콜이며 서버와 클라이언트로 구현됨
- HTTP는 웹 클라이언트가 웹서버에게 웹페이지를 어떻게 요청하는지와 서버가 클라이언트로 어떻게 웹페이지를 전송하는지를 정의함
- HTTP는 TCP를 전송 프로토콜로 이용함
- HTTP 서버는 클라이언트에 대한 정보를 유지하지 않으므로 비상태 프로토콜이라고 부름

### 2.2.2 비지속 연결과 지속연결

- 비지속 연결 = 각 요구/응답 쌍이 분리된 TCP 연결을 통해 전해지는 것
- RTT = 패킷이 클라이언트에서 송신되어 서버를 거쳐 다시 클라이언트로 돌아오는데 걸리는 시간
- 지속 연결 = 모든 요구와 응답들이 같은 TCP 연결을 통해 전해지는 것

### 2.2.3 HTTP 메시지 포맷

- HTTP 요청 메시지의 구성
  - 요청라인 : 요청방식과 URL, HTTP 버전 필드가 존재
  - 헤더라인 : 나머지 정보들을 포함하고 있음
- HTTP 응답 메시지의 구성
  - 상태라인 : 상태코드와 상태 텍스트가 존재
  - 헤더라인 : 나머지 정보들을 포함하고 있음
  - 개체몸체 : 요청된 데이터가 존재

### 2.2.4 사용자와 서버 간의 상호작용: 쿠키

- 쿠키 = 서버가 사용자의 상태 정보를 저장하는 수단
- 서비스 제공자가 사용자 맞춤 정보를 제공할 수 있음

### 2.2.5 웹 캐싱

- 웹 캐시 = 기점 웹서버를 대신하여 HTTP 요구를 충족시키는 네트워크 개체
- 캐시는 서버이면서 클라이언트
- CDN(Content Distribution Network) = 콘텐츠 전송 네트워크
- 조건부 GET(Conditional GET) = 클라이언트가 브라우저로 전달되는 모든 객체가 최신의 것인지 확인하면서 캐싱 해줌

### 2.2.6 HTTP/2

- 하나의 TCP 연결상에서 멀티플렉싱 요청/응답 지연 시간을 줄이는 것이 목적
- 요청 우선순위화, 서버 푸시, HTTP 헤더 필드의 효율적인 압축 기능 등을 제공
- HOL(Head of Line) 블로킹 = 대용량의 데이터가 후미에 따라오는 작은 용량의 데이터가 송신되는걸 막는 현상
- HTTP/2 프레이밍 = 메시지를 작은 프레임으로 나눠 전송하고, 같은 TCP 연결에서의 요청과 응답 메시지를 재조립
- 메시지 우선순위화(message prioritization) = 요청들의 상대적 우선순위를 조정하여 애플리케이션 성능을 최적화
- 서버푸시 = 클라이언트의 요청 없이도 추가적인 객체를 클라이언트에게 푸시하는 것

## 2.3 인터넷 전자메일

- 사용자 에이전트, 메일서버, SMTP로 구성
- 메일은 메일박스에 저장되며 메시지 전송 실패시 메시지 큐에 보관후 재시도
- SMTP는 인터넷 전자메일을 위한 주요 애플리케이션 계층 프로토콜

### 2.3.1 SMTP

- SMTP는 송신자의 메일 서버로부터 수신자의 메일 서버로 메시지를 전송함
- SMTP는 지속 연결을 사용함

### 2.3.2 메일 메시지 포맷

- 메일 메시지는 메시지 헤더와 메시지 몸체로 이루어짐

### 2.3.3 메일 접속 프로토콜

- SMTP는 푸시 프로토콜이고 메시지를 얻는 것은 풀 동작임
- IMAP(Internet Mail Access Protocol) = 메일 서버에서 메일 클라이언트로 메일을 푸시하는 프로토콜
