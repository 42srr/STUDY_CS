# 인터넷 라우팅, 자율 시스템 및 SDN

## 1. 자율 시스템(AS)과 BGP

### 자율 시스템(Autonomous System, AS)

- 단일 관리 기관의 제어 하에 있는 라우터와 네트워크 집합
- 각 AS는 고유한 AS 번호(ASN)로 식별됨
- 인터넷은 서로 연결된 수천 개의 AS로 구성됨

### BGP(Border Gateway Protocol)

- **BGP의 역할**: 인터넷 서비스 제공업체(ISP) 간의 라우팅 프로토콜
- 자율 시스템 간 라우팅을 담당하는 외부 게이트웨이 프로토콜
- 인터넷의 글로벌 라우팅 테이블을 관리
- 정책 기반 라우팅 지원

### BGP 경로 정보 알리기

- BGP 스피커(라우터)는 TCP 연결을 통해 BGP 피어와 통신
- 경로 정보는 BGP 업데이트 메시지를 통해 전파
- 각 업데이트에는 목적지 네트워크, 경로 속성, AS 경로 등 포함
- 경로 벡터 알고리즘 사용: 경로 상의 모든 AS 순서 포함

### BGP 경로 결정

1. 로컬 선호도 값이 높은 경로 선택
2. AS 경로 길이가 짧은 경로 선택
3. 가장 가까운 다음 홉 라우터를 가진 경로 선택
4. 라우터 ID가 낮은 BGP 스피커로부터 수신된 경로 선택

### 뜨거운 감자 라우팅(Hot Potato Routing)

- 가능한 빨리 트래픽을 다른 AS로 전달하는 전략
- 네트워크 내부 비용을 최소화하기 위해 가장 가까운 출구 지점 선택
- ISP의 내부 자원 사용을 최적화하는 이기적 라우팅 방식

### IP 애니캐스트(IP Anycast)

- 동일한 IP 주소가 여러 지리적 위치에 배포
- 요청은 BGP 라우팅을 통해 가장 가까운 서버로 라우팅
- DNS 루트 서버, CDN 등에 활용
- 가용성 향상 및 DDoS 공격 완화에 효과적

### 라우팅 정책과 다중 홈 접속 ISP

- **라우팅 정책**: ISP가 트래픽 흐름을 제어하는 규칙
- **다중 홈 접속(Multi-homing)**: 하나의 AS가 여러 ISP에 연결
  - 연결 중복성 및 신뢰성 향상
  - 트래픽 부하 분산
  - 경로 최적화 가능

## 2. 소프트웨어 정의 네트워킹(SDN)

### SDN 구조의 네 가지 특징

1. **플로우 기반 포워딩**

   - 패킷 헤더 필드 집합에 따라 포워딩 결정
   - 유연한 패킷 처리 규칙 정의 가능

2. **데이터 평면과 제어 평면의 분리**

   - 데이터 평면: 패킷 포워딩 담당
   - 제어 평면: 포워딩 규칙 결정 담당
   - 분리를 통해 네트워크 관리 및 프로그래밍 용이

3. **네트워크 제어 기능이 데이터 평면 스위치 외부에 존재**

   - 제어 로직이 중앙 컨트롤러로 이동
   - 네트워크 전체에 대한 글로벌 뷰 제공

4. **프로그램이 가능한 네트워크**
   - API를 통해 네트워크 동작을 소프트웨어로 제어
   - 자동화 및 빠른 서비스 배포 가능

### SDN 제어 평면: SDN 컨트롤러와 네트워크 제어 애플리케이션

1. **통신 계층**

   - 데이터 평면 장치와 통신
   - OpenFlow 같은 프로토콜 사용

2. **네트워크 전역 상태 관리 계층**

   - 네트워크 토폴로지, 상태 정보 유지
   - 일관된 네트워크 뷰 제공

3. **네트워크 제어 애플리케이션 계층과의 인터페이스**
   - 북쪽 API를 통해 애플리케이션과 통신
   - 애플리케이션의 요구사항을 네트워크 구성으로 변환

### OpenFlow 프로토콜

- SDN 컨트롤러와 스위치 간의 표준 통신 프로토콜
- 주요 메시지 유형:
  - **설정**: 컨트롤러-스위치 간 연결 설정
  - **상태 수정**: 플로우 테이블 업데이트
  - **상태 읽기**: 스위치 상태 및 통계 요청
  - **패킷 전송**: 컨트롤러에서 스위치로 패킷 전송
  - **플로우 제거**: 기존 플로우 항목 삭제
  - **포트 상태**: 포트 상태 변경 알림
  - **패킷 전달**: 스위치에서 컨트롤러로 패킷 전송

### 데이터 평면과 제어 평면의 상호작용

1. 스위치는 패킷 도착 시 플로우 테이블 확인
2. 일치하는 규칙이 있으면 해당 액션 수행
3. 일치하는 규칙이 없으면 컨트롤러에 패킷 전송
4. 컨트롤러는 적절한 규칙을 결정하여 스위치에 설치
5. 이후 동일한 플로우의 패킷은 스위치에서 직접 처리

### SDN: 과거와 미래

- 초기에는 데이터 센터와 캠퍼스 네트워크에 주로 적용
- 현재는 클라우드 환경, 네트워크 가상화, 5G 네트워크 등으로 확장
- 머신러닝과 결합하여 자율 네트워킹 발전 중

## 3. 네트워크 관리 및 프로토콜

### 인터넷 제어 메시지 프로토콜(ICMP)

- IP 프로토콜의 보조 프로토콜
- 오류 보고 및 네트워크 상태 진단
- ping과 traceroute 같은 도구의 기반
- 타입과 코드로 다양한 메시지 구분

### 네트워크 관리와 SNMP, NETCONF/YANG

#### 네트워크 관리 프레임워크

- **관리 서버**: 네트워크 관리 애플리케이션 실행
- **피관리 장치**: 라우터, 스위치, 서버 등
- **데이터**: 장치 상태, 성능, 구성 정보
- **네트워크 관리 에이전트**: 피관리 장치에서 실행되는 소프트웨어
- **네트워크 관리 프로토콜**: 서버와 에이전트 간 통신 프로토콜

#### SNMP(Simple Network Management Protocol)와 MIB

- 네트워크 장치 모니터링 및 제어를 위한 프로토콜
- 요청-응답 모델과 트랩 메시지 지원
- 장치 상태 조회 및 설정 변경 가능

#### MIB(Management Information Base)

- 네트워크 장치의 관리 가능한 객체 계층 구조
- 객체 식별자(OID)로 각 객체 참조
- 표준화된 MIB과 벤더별 확장 MIB 존재

#### NETCONF(Network Configuration Protocol)과 YANG

- XML 기반 네트워크 구성 관리 프로토콜
- SNMP보다 강력한 구성 관리 기능 제공
- 구성 데이터의 트랜잭션 지원

#### YANG(Yet Another Next Generation)

- NETCONF용 데이터 모델링 언어
- 네트워크 장치 구성 및 상태 데이터 모델링
- 모듈화되고 확장 가능한 구조
- 데이터 유효성 검사 지원

## 인터넷 존재 확인하기

- 다양한 프로토콜, 알고리즘, 시스템이 협력하여 인터넷 구성
- 자율 시스템 간의 BGP를 통한 상호 연결
- SDN을 통한 네트워크 프로그래밍 가능성 확장
- ICMP, SNMP, NETCONF/YANG 등을 통한 효율적인 네트워크 관리
