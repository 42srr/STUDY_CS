# 5 네트워크 계층 : 제어 평면

## 5.5 소프트웨어 정의 네트워크 (SDN) 제어평면

- SDN 구조의 네 가지 특징

1. 플로우 기반 포워딩

   - SDM으로 제어되는 스위치들에서의 패킷 전달은 트랜스포트 계층, 네트워크 계층, 링크 계층 헤더의 값을 기반으로 포워딩할 수 있도록 허용
   - SDN에서는 모든 네트워크 스위치의 플로우 테이블 항목을 계산하고 관리, 설치함

2. 데이터 평면과 제어 평면의 분리

   - 데이터 평면은 네트워크 스위치들로 구성 -> 상대적으로 단순한 장치로 자신들의 플로우 테이블 내용 기반으로 매치 플러스 액션 수행.

3. 네트워크 제어 기능이 데이터 평면 스위치 외부에 존재

   - 전통적인 라우터와 달리, 네트워크 스의치로부터 멀리 떨어진 별도의 서버에서 수행
   - SDN 컨트롤러와 네트워크 제어 어플리케이션의 집합으로 이루어짐.
   - 컨트롤러는 정확한 상태정보를 유지, 해당 정보를 제어 평면에서 동작하고 있는 네트워크 제어 에필르케이션을 제공하며, 애플리케이션들이 하부 네트워크 장치들을 모니터하고 프로그램하고 제어까지 할 수 있도록 수단을 제공.

4. 프로그램이 가능한 네트워크
   - 제어 평면에서 수행중인 네트워크 제어 애플리케이션을 통해 네트워크를 프로그램할 수 있다.

## 5.5.1 SDN 제어 평면 : SDN 컨트럴로와 SDN 네트워크 제어 애플리케이션

- 컨트롤러의 기능은 크게 3개의 계층으로 구성

1. 통신 계층 : SDN 컨트롤러와 제어받는 네트워크 장치들 사이의 통신.
2. 네트워크 전역 상태 관리 계층 : SDN 제어 평면의 궁극적이내 제어 결정.
3. 네트워크 제어 애플리케이션 계층과 인터페이스 : 노스바운드 인터페이스를 통해 네트워크 제어 애플리케이션과 상호작용.

### 5.5.2 OpenFlow 프로토콜

- 컨트롤러가 제어되는 수위츠로 전달하는 메시지는 다음과 같음.
  - 설정 : 컨트롤러가 스위치의 설정 파라미터들 문의나 설정
  - 상태 수정 : 컨트롤러가 스위치 플로우 테이블의 엔트리 추가/제거/수정
  - 상태 읽기 : 스위치 플로우 테이블과 포트로부터 통계 정보와 카운터 값 얻기 위함
  - 패킷 전송 : 스위치의 지정된 포트에서 특정 패킷을 내보내기 위해 사용.
  - 플로우 제거 : 플로우 테이블 엔트리가 시간이 만료, 상태 수정 메시지 수신한 결과 삭제됨을 알림
  - 포트 상태 : 포트의 상태 변화를 알리기 위해 사용
  - 패킷 전달 : 플로우 테이블의 어떤 엔트리와도 일치하지 않은 패킷을 처리하기 위해 컨트롤러에게 전달.

### 5.5.3 테이터 평관과 제어 평면의 상호작용 : 예제

- 읽어보기

### 5.5.4 SDN : 과거와 미래

## 5.6 인터넷 제어 메시지 프로토콜(ICMP)

- ICMP는 호스트와 라우터가 서로 간에 네트워크 계층 정보를 주고받기 위해 사용.
- ICMP는 IP의 한 부분으로 간주되지만, IP 데이터그램에 담겨 전송되므로 구조적으로 IP 바로 위에 있음.
- ICMP 메시지에는 타입과 코드필드가 있고, ICMP 메시지의 발생 원인이된 IP 데이터그램의 헤더와 첫 8바이트를 갖는다.
- ICMP 메시지는 출발 억제 메시지.

## 5.7 네트워크 관라와 SNMP, NETCONF/YANG

- 네트워크 관리란?
  - 네트워크 관리는 적정한 비용으로 실시간, 운용 성능, 서비스 품질 등의 요구사항을 만족시키기 위해 네트워크와 구성요소 자원을 감시, 테스트, 폴링, 설정, 평가, 분석, 제어하는 하드웨어, 소프트웨어, 인간 요소등을 배치하고, 통합, 조정하는 것.

### 5.7.1 네트워크 관리 프레임워크

- 관리 서버 : 네트워크 관리자와 상호작용 애플리케이션
- 피관리 장치 : 네트워크에 존재하는 네트워크 장비
- 테이터 : 피관리 장치는 '상태'라고 부르는 장치와 관련된 데이터 갖음(설정 데이터, 동작 데이터, 장치 통계)
- 네트워크 관리 에이전트 : 관리 서버와 통신하는 피관리 장치상의 소프트웨어 프로세스
- 네트워크 관리 프로토콜

* 네트워크 관리 세 가지 방법
* CLI : 명령줄 인터페이스
* SNMP/MIB : SNMP를 사용해 장치 MIN 데이터 질의나 설정
* NETCONF/YANG

### 5.7.2 SNMP/MIB

- SNMPv3 : 관리 서버와 그 관리 서버를 대표하여 실행되고 있는 에이전트 사이에서 네트워크 관리 제어 및 정보 메시지를 전달하기 위해 사용.

* SNMP : 요청-응답모드를 사장 흔하게 사용
* SNMP : 에이전트 요구 받지 않더라도 트랩 메시지라는 이름의 메시지를 관리 서버에 전달.
* SNMPv3 일곱 가지 타입 메시지
  - GetRequest : 관리자-에이전트
  - GetNextRequset : 관리자-에이전트
  - GetBulkRequset : 관리자-에이전트
  - InformRequset : 관리자-관리자
  - SetRequset : 관리자-에이전트
  - Rsponse : 에이전트-관리자 또는 관리자-관리자
  - SNMPv2-Trap : 에이전트-관리자

#### MIB

- MIN 객체는 IP 데이터그램 헤더의 오류로 인해 라우터에서 버려지는 데이터그램 개수나 이더넷 인터페이스 카다의 반송파 감지 오류 횟수를 세는 카운터일수도 있고, DNS 서버에서 실행되는 소프트웨어 버전과 같은 설명 정보, 특정 장치가 올브라게 작동하는 여부와 같은 상태 정보, 또는 라우팅 경로 같은 프로코톨에 특정된 정보 일 수 있음.

### 5.7.3 네트워크 설정 프로토콜(NETCONF), YANG

- NETCONF 프로토콜은 관리 서버와 피관리 네트워크 사이에서 동작
  - 1.  피관리 장치의 설정 데이터 검색, 셋업 수정
  - 2.  피관리 장치의 동작 데이터 및 통계 질의
  - 3.  피관리 장치에서 생성된 알림 구독

* NETCONF 주요 작업
  - get-config : 전체 또는 일부 검색
  - get : 설정 상태 . 및동작 데이터 전체 일부 검색
  - edit-config : 피관리 장치 특정 설정의 전체 또는 일부 변경
  - lock, unlock : 관리 서버는 피관리 장치의 전체 설정 데이터 저장소 시스템을 잠그거나 해제 함.
  - creat-subscription, notification : 종료할때까지 관심있는 특정 이벤트에 대한 notification을 피관리 장치에서 관리 서버로 비동기 방식으로 보내도록 지시

#### YANG

- YANG : SMI, SNMP, MIB를 기술하는 데 사용되는 것과 거의 동일한 방식으로 NETCONF가 사용되는 네트워크 관리 데이터의 구조, 구문 및 의미를 정확하게 표현하는데 사용되는 데이터 모델링 언어.
